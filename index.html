<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>express-static-files-manager</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.js" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">express-static-files-manager</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
							<input type="checkbox" id="tsd-filter-only-exported" />
							<label class="tsd-widget" for="tsd-filter-only-exported">Only exported</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="globals.html">Globals</a>
				</li>
			</ul>
			<h1> express-static-files-manager</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<p><a href="https://www.npmjs.com/package/express-static-files-manager"><img src="https://img.shields.io/npm/v/express-static-files-manager.svg" alt="npm (scoped)"></a></p>
				<a href="#express-static-files-manager" id="express-static-files-manager" style="color: inherit; text-decoration: none;">
					<h1>express-static-files-manager</h1>
				</a>
				<a href="#installation" id="installation" style="color: inherit; text-decoration: none;">
					<h2>Installation</h2>
				</a>
				<p><code>npm i express-static-files-manager</code></p>
				<a href="#motivations" id="motivations" style="color: inherit; text-decoration: none;">
					<h2>Motivations</h2>
				</a>
				<p>On some of our projects, we use a pattern that allows us to have a single hosting point. We use express static files to serve the frontend directly from our backend (in this case an express app). The motivation behind this package comes from the need we had to automatically update the files served by our backend and not manually copy our React project build each time into the public folder and then redeploying the updated backend. This package is also taking care of automatically updating the served frontend based on its current repository state. If the webhook is set up it will clone, rebuild and update the served files all by itself upon new commits.</p>
				<a href="#usage" id="usage" style="color: inherit; text-decoration: none;">
					<h2>Usage</h2>
				</a>
				<a href="#managestaticfilesservingconfig--config" id="managestaticfilesservingconfig--config" style="color: inherit; text-decoration: none;">
					<h3>manageStaticFilesServing(config : Config)</h3>
				</a>
				<p>The only function that needs to be called when your express app starts.
				This will clone your project, build it and then place it within your <code>/public</code> directory (or the custom public directory if that is set) ready to be served by your express webserver. For this package, the default location of the <code>/public</code> directory is at the root of your project. If you set up the webhook, this will also automatically update your served files within the <code>/public</code> directory upon new commits.</p>
				<p><code>index.ts</code></p>
				<pre><code class="language-js"><span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">'express'</span>;
<span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">'path'</span>;
<span class="hljs-keyword">import</span> { manageStaticFilesServing } <span class="hljs-keyword">from</span> <span class="hljs-string">'express-static-files-manager'</span>;

<span class="hljs-keyword">const</span> app = express();

app.use(express.static(path.join(__dirname, <span class="hljs-string">'../public'</span>)));

manageStaticFilesServing({
  <span class="hljs-attr">repoUrl</span>: <span class="hljs-string">'https://github.com/Username/yourReponame'</span>,
  <span class="hljs-attr">showConsoleLog</span>: <span class="hljs-literal">true</span>
});</code></pre>
				<a href="#config" id="config" style="color: inherit; text-decoration: none;">
					<h4>Config</h4>
				</a>
				<table>
					<thead>
						<tr>
							<th><strong>field</strong></th>
							<th><strong>type</strong></th>
							<th><strong>defaultValue</strong></th>
							<th><strong>mandatory</strong></th>
							<th><strong>description</strong></th>
						</tr>
					</thead>
					<tbody><tr>
							<td>repoUrl</td>
							<td>string</td>
							<td>undefined</td>
							<td>yes</td>
							<td>Your repository&#39;s URL</td>
						</tr>
						<tr>
							<td>onHookReceived</td>
							<td>function</td>
							<td>undefined</td>
							<td>no</td>
							<td>Overwrites default express-static-files-manager hook controller passing express res, req and next fields to your function</td>
						</tr>
						<tr>
							<td>onStartBuild</td>
							<td>function</td>
							<td>undefined</td>
							<td>no</td>
							<td>Function called on build start</td>
						</tr>
						<tr>
							<td>onError</td>
							<td>function</td>
							<td>undefined</td>
							<td>no</td>
							<td>Function called on error</td>
						</tr>
						<tr>
							<td>onFinish</td>
							<td>function</td>
							<td>undefined</td>
							<td>no</td>
							<td>Function called on build finish</td>
						</tr>
						<tr>
							<td>githubUsername</td>
							<td>string</td>
							<td>undefined</td>
							<td>no</td>
							<td>Your github username</td>
						</tr>
						<tr>
							<td>githubPassword</td>
							<td>string</td>
							<td>undefined</td>
							<td>no</td>
							<td>Your github password</td>
						</tr>
						<tr>
							<td>githubToken</td>
							<td>string</td>
							<td>undefined</td>
							<td>no</td>
							<td>Your github OAuth token</td>
						</tr>
						<tr>
							<td>allowStdio</td>
							<td>boolean</td>
							<td>false</td>
							<td>no</td>
							<td>Setting this to true will pipe to stdio</td>
						</tr>
						<tr>
							<td>showConsoleLog</td>
							<td>boolean</td>
							<td>false</td>
							<td>no</td>
							<td>Setting this to true will log the whole process</td>
						</tr>
						<tr>
							<td>skipNpmInstall</td>
							<td>boolean</td>
							<td>false</td>
							<td>no</td>
							<td>If you wish to skip npm install phase</td>
						</tr>
						<tr>
							<td>skipBuildPhase</td>
							<td>boolean</td>
							<td>false</td>
							<td>no</td>
							<td>If you wish to skip build phase</td>
						</tr>
						<tr>
							<td>branch</td>
							<td>string</td>
							<td>&quot;master&quot;</td>
							<td>no</td>
							<td>Your branch name</td>
						</tr>
						<tr>
							<td>customPublicDir</td>
							<td>string</td>
							<td>&quot;public&quot;</td>
							<td>no</td>
							<td>The directory containing your public static files</td>
						</tr>
						<tr>
							<td>customWorkDir</td>
							<td>string</td>
							<td>$currentDir</td>
							<td>no</td>
							<td>The directory where builds are generated and processed</td>
						</tr>
						<tr>
							<td>customBuildScript</td>
							<td>string</td>
							<td>&quot;build&quot;</td>
							<td>no</td>
							<td>Set a custom script to use in your packages.json to build your files</td>
						</tr>
						<tr>
							<td>webhookConfig</td>
							<td>WebhookConfig</td>
							<td>undefined</td>
							<td>no</td>
							<td>The webhook config</td>
						</tr>
				</tbody></table>
				<a href="#webhookconfig" id="webhookconfig" style="color: inherit; text-decoration: none;">
					<h4>WebhookConfig</h4>
				</a>
				<table>
					<thead>
						<tr>
							<th><strong>field</strong></th>
							<th><strong>type</strong></th>
							<th><strong>defaultValue</strong></th>
							<th><strong>mandatory</strong></th>
							<th><strong>description</strong></th>
						</tr>
					</thead>
					<tbody><tr>
							<td>expressApp</td>
							<td>object</td>
							<td>undefined</td>
							<td>yes</td>
							<td>Your express app (<code>const expressApp = express();</code>)</td>
						</tr>
						<tr>
							<td>endpoint</td>
							<td>string</td>
							<td>undefined</td>
							<td>yes</td>
							<td>The endpoint called by your github hook</td>
						</tr>
						<tr>
							<td>secret</td>
							<td>string</td>
							<td>undefined</td>
							<td>no</td>
							<td>The secret passphrase associated to your github hook</td>
						</tr>
				</tbody></table>
				<a href="#webhook-usage" id="webhook-usage" style="color: inherit; text-decoration: none;">
					<h2>Webhook usage</h2>
				</a>
				<ul>
					<li>Declare a webhook manually on your repository <a href="https://github.com/%7ByourOrganization%7D/%7BrepostoryName%7D/settings/hooks/new">https://github.com/{yourOrganization}/{repostoryName}/settings/hooks/new</a></li>
					<li>Assign it a route and express-static-files-manager will automatically take care of that endpoint as long as you set <code>webhookConfig.callbackUrl</code> accordingly.</li>
					<li>Create a secret passphrase and set <code>webhookConfig.secret</code> accordingly.</li>
				</ul>
				<p><code>index.ts</code></p>
				<pre><code class="language-js"><span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">'express'</span>;
<span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">'path'</span>;
<span class="hljs-keyword">import</span> { manageStaticFilesServing } <span class="hljs-keyword">from</span> <span class="hljs-string">'express-static-files-manager'</span>;

<span class="hljs-keyword">const</span> app = express();

app.use(express.static(path.join(__dirname, <span class="hljs-string">'../public'</span>)));

manageStaticFilesServing({
  <span class="hljs-attr">repoUrl</span>: <span class="hljs-string">'https://github.com/yourUserName/yourRepositoryName'</span>,
  <span class="hljs-attr">branch</span>: <span class="hljs-string">'production'</span>,
  <span class="hljs-attr">webhookConfig</span>: {
    <span class="hljs-attr">endpoint</span>: <span class="hljs-string">'/githubhook'</span>,
    <span class="hljs-attr">secret</span>: <span class="hljs-string">'yoursupertopsecret'</span>,
    <span class="hljs-attr">expressApp</span>: app
  }
});</code></pre>
				<a href="#github-credentials" id="github-credentials" style="color: inherit; text-decoration: none;">
					<h2>Github credentials</h2>
				</a>
				<p>If your repository is private, make sure to either ideally set your SSH key on your hosting machine or alternately set <code>githubUsername</code> and <code>githubPassword</code>. You can also use a github access token for the <code>githubToken</code>. If you take this path, consider setting up a bot with limited access rights to your repository.</p>
				<a href="#disclaimer" id="disclaimer" style="color: inherit; text-decoration: none;">
					<h2>Disclaimer</h2>
				</a>
				<p>This is still in early stage development. Not production ready. Use it at your own risks.</p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="globals  ">
						<a href="globals.html"><em>Globals</em></a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
					<li class=" tsd-kind-interface tsd-is-not-exported">
						<a href="interfaces/config.html" class="tsd-kind-icon">Config</a>
					</li>
					<li class=" tsd-kind-variable tsd-is-not-exported">
						<a href="globals.html#isbuilding" class="tsd-kind-icon">is<wbr>Building</a>
					</li>
					<li class=" tsd-kind-variable tsd-is-not-exported">
						<a href="globals.html#pendingbuild" class="tsd-kind-icon">pending<wbr>Build</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="globals.html#asyncabc" class="tsd-kind-icon">asyncABC</a>
					</li>
					<li class=" tsd-kind-function tsd-is-not-exported">
						<a href="globals.html#createwebhook" class="tsd-kind-icon">create<wbr>Webhook</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="globals.html#double" class="tsd-kind-icon">double</a>
					</li>
					<li class=" tsd-kind-function tsd-is-not-exported">
						<a href="globals.html#fetchpublicfiles" class="tsd-kind-icon">fetch<wbr>Public<wbr>Files</a>
					</li>
					<li class=" tsd-kind-function tsd-is-not-exported">
						<a href="globals.html#getisbuilding" class="tsd-kind-icon">get<wbr>IsBuilding</a>
					</li>
					<li class=" tsd-kind-function tsd-is-not-exported">
						<a href="globals.html#getpendingbuild" class="tsd-kind-icon">get<wbr>Pending<wbr>Build</a>
					</li>
					<li class=" tsd-kind-function tsd-is-not-exported">
						<a href="globals.html#handlehookcallback" class="tsd-kind-icon">handle<wbr>Hook<wbr>Callback</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="globals.html#managestaticfilesserving" class="tsd-kind-icon">manage<wbr>Static<wbr>Files<wbr>Serving</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="globals.html#power" class="tsd-kind-icon">power</a>
					</li>
					<li class=" tsd-kind-function tsd-is-not-exported">
						<a href="globals.html#setisbuilding" class="tsd-kind-icon">set<wbr>IsBuilding</a>
					</li>
					<li class=" tsd-kind-function tsd-is-not-exported">
						<a href="globals.html#setpendingbuild" class="tsd-kind-icon">set<wbr>Pending<wbr>Build</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="globals.html#sha256" class="tsd-kind-icon">sha256</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="globals.html#sha256native" class="tsd-kind-icon">sha256<wbr>Native</a>
					</li>
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-module"><span class="tsd-kind-icon">Module</span></li>
				<li class="tsd-kind-object-literal"><span class="tsd-kind-icon">Object literal</span></li>
				<li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li>
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
				<li class="tsd-kind-function tsd-has-type-parameter"><span class="tsd-kind-icon">Function with type parameter</span></li>
				<li class="tsd-kind-index-signature"><span class="tsd-kind-icon">Index signature</span></li>
				<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
				<li class="tsd-kind-type-alias tsd-has-type-parameter"><span class="tsd-kind-icon">Type alias with type parameter</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li>
				<li class="tsd-kind-enum-member"><span class="tsd-kind-icon">Enumeration member</span></li>
				<li class="tsd-kind-property tsd-parent-kind-enum"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-enum"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li>
				<li class="tsd-kind-interface tsd-has-type-parameter"><span class="tsd-kind-icon">Interface with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-interface"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-interface"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
				<li class="tsd-kind-class tsd-has-type-parameter"><span class="tsd-kind-icon">Class with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class"><span class="tsd-kind-icon">Accessor</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-class"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static property</span></li>
				<li class="tsd-kind-call-signature tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
<script>if (location.protocol == 'file:') document.write('<script src="assets/js/search.js"><' + '/script>');</script>
</body>
</html>